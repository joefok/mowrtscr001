<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Face Jumper Game</title>
  <style>
    body { margin: 0; overflow: hidden; background: #87CEEB; }
    canvas { display: block; margin: auto; background: #fff; }
  </style>
</head>
<body>
<canvas id="game" width="400" height="600"></canvas>
https://cdn.jsdelivr.net/npm/@tensorflow/tfjs</script>
https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection</script>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let player = {
  x: 180,
  y: 500,
  width: 40,
  height: 40,
  vy: 0,
  gravity: 0.5,
  jumpStrength: -10,
};

let platforms = [];
let detector;

function createPlatform(y) {
  let x = Math.random() * (canvas.width - 60);
  platforms.push({ x, y, width: 60, height: 10 });
}

for (let i = 0; i < 10; i++) {
  createPlatform(600 - i * 60);
}

function update() {
  player.vy += player.gravity;
  player.y += player.vy;

  // Collision with platforms
  platforms.forEach(p => {
    if (
      player.vy > 0 &&
      player.x + player.width > p.x &&
      player.x < p.x + p.width &&
      player.y + player.height > p.y &&
      player.y + player.height < p.y + p.height + player.vy
    ) {
      player.vy = player.jumpStrength;
      player.width += 2;
      player.height += 2;
    }
  });

  // Scroll platforms
  if (player.y < 300) {
    let dy = 300 - player.y;
    player.y = 300;
    platforms.forEach(p => {
      p.y += dy;
      if (p.y > canvas.height) {
        platforms.splice(platforms.indexOf(p), 1);
        createPlatform(0);
      }
    });
  }

  // Wrap around
  if (player.x < -player.width) player.x = canvas.width;
  if (player.x > canvas.width) player.x = -player.width;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw player
  ctx.fillStyle = 'red';
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // Draw platforms
  ctx.fillStyle = 'green';
  platforms.forEach(p => {
    ctx.fillRect(p.x, p.y, p.width, p.height);
  });
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

async function initCameraAndModel() {
  const video = document.createElement('video');
  video.width = 300;
  video.height = 300;
  video.style.position = 'absolute';
  video.style.top = '-9999px'; // hide video
  document.body.appendChild(video);

  const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
  video.srcObject = stream;
  await video.play();

  detector = await poseDetection.createDetector(poseDetection.SupportedModels.MoveNet);
  detectPose(video);
}

async function detectPose(video) {
  const poses = await detector.estimatePoses(video);
  if (poses.length > 0) {
    const nose = poses[0].keypoints.find(k => k.name === 'nose');
    if (nose && nose.score > 0.5 && nose.y < 100) {
      player.vy = player.jumpStrength;
    }
  }
  requestAnimationFrame(() => detectPose(video));
}

initCameraAndModel();
loop();
</script>
</body>
</html>